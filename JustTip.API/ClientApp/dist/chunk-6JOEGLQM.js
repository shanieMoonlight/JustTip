import{a as N}from"./chunk-VQV6X66N.js";import{a as G}from"./chunk-4IF4V5CL.js";import{b as z,g as A,i as L,j as q}from"./chunk-BAMGXGUD.js";import{Bb as g,Db as $,Eb as j,Ha as R,Ia as I,Ja as h,La as b,Ma as y,Na as d,Oa as l,Ob as E,P as x,Pa as s,Qa as u,R as m,S as p,Va as w,Xa as f,Ya as c,db as D,dc as U,hb as _,ib as T,jb as O,kb as k,la as a,qb as J,rc as V,sc as W,tc as B,ub as C,va as v,wb as S,xb as F,za as P}from"./chunk-5OZSCIHB.js";function Y(i,t){if(i&1&&(l(0,"th",2),_(1),C(2,"date"),s()),i&2){let e=t.$implicit;a(),T(S(2,1,e.date,"EEE. MMM d"))}}function Z(i,t){if(i&1){let e=w();l(0,"div",11),f("click",function(){let o=m(e).$implicit,n=c(4);return p(n.edit(o))})("keydown.enter",function(){let o=m(e).$implicit,n=c(4);return p(n.edit(o))})("keydown.space",function(){let o=m(e).$implicit,n=c(4);return p(n.edit(o))}),_(1),C(2,"date"),C(3,"date"),s()}if(i&2){let e=t.$implicit;a(),k(" ",S(2,2,e.startTime,"shortTime")," \u2014 ",S(3,5,e.endTime,"shortTime")," ")}}function ee(i,t){if(i&1&&b(0,Z,4,8,"div",10,h),i&2){let e=c().$implicit,r=c().$implicit,o=c();y(o.getShifts(r.employeeId,e.date))}}function te(i,t){i&1&&u(0,"div",9)}function ie(i,t){if(i&1&&(l(0,"td",8),R(1,ee,2,0)(2,te,1,0,"div",9),s()),i&2){let e=t.$implicit,r=c().$implicit,o=c();a(),I(o.getShifts(r.employeeId,e.date).length?1:2)}}function re(i,t){if(i&1&&(l(0,"tr")(1,"td",3)(2,"div",4)(3,"div",5)(4,"jt-ui-icon",6),_(5,"face"),s()(),l(6,"div",7),_(7),s()()(),b(8,ie,3,1,"td",8,h),s()),i&2){let e=t.$implicit,r=c();a(4),d("iconSizePx",28),a(3),T(e.employeeName),a(),y(r.rosterDays())}}var M=class i{roster=j.required({});selectedShiftItem=$({});rosterDays=g(()=>this.roster()?.days??[]);employees=g(()=>{let t=this.rosterDays(),e=new Map;for(let r of t)for(let o of r.shifts??[]){let n=o.employeeId??o.employeeName??JSON.stringify(o);e.has(n)||e.set(n,{employeeId:o.employeeId,employeeName:o.employeeName})}return Array.from(e.values())});getShifts(t,e){let o=(this.rosterDays()??[]).find(n=>n.date===e);return o?(o.shifts??[]).filter(n=>(n.employeeId??n.employeeName)===(t??n.employeeName??"")):[]}edit=t=>this.selectedShiftItem.emit(t);static \u0275fac=function(e){return new(e||i)};static \u0275cmp=v({type:i,selectors:[["jt-ui-roster-table"]],inputs:{roster:[1,"roster"]},outputs:{selectedShiftItem:"selectedShiftItem"},decls:9,vars:0,consts:[["role","table",1,"roster-table"],["scope","col",1,"name-col","blank"],["scope","col",1,"date-col"],[1,"name-col"],[1,"name-cell"],[1,"avatar"],[3,"iconSizePx"],[1,"employee-name"],[1,"cell"],[1,"empty"],["role","button","tabindex","0",1,"shift"],["role","button","tabindex","0",1,"shift",3,"click","keydown.enter","keydown.space"]],template:function(e,r){e&1&&(l(0,"table",0)(1,"thead")(2,"tr"),u(3,"th",1),b(4,Y,3,4,"th",2,h),s()(),l(6,"tbody"),b(7,re,10,2,"tr",null,h),s()()),e&2&&(a(4),y(r.rosterDays()),a(3),y(r.employees()))},dependencies:[W,E],styles:["[_nghost-%COMP%]{display:block;--divider-color: rgba(0, 0, 0, .06);--cell-width: 160px;--cell-min-width: 120px;width:100%}.roster-table[_ngcontent-%COMP%]{margin:auto;border-collapse:collapse;table-layout:fixed;table-layout:auto}.roster-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .roster-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:12px 10px;border:1px solid var(--divider-color);vertical-align:middle;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.roster-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{top:0;z-index:3;font-weight:600;text-align:center}.roster-table[_ngcontent-%COMP%]   .name-col[_ngcontent-%COMP%]{text-align:left;gap:8px;left:0;z-index:2}.name-cell[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px}.roster-table[_ngcontent-%COMP%]   .date-col[_ngcontent-%COMP%], .roster-table[_ngcontent-%COMP%]   .cell[_ngcontent-%COMP%]{text-align:center}.shift[_ngcontent-%COMP%]{font-size:.9rem;font-size:.75rem;cursor:pointer}.empty[_ngcontent-%COMP%]{height:1.2rem}.avatar[_ngcontent-%COMP%]{width:32px;height:32px;border-radius:50%;display:inline-flex;align-items:center;justify-content:center;background:var(--mat-sys-secondary-container, #f2f2f2)}.employee-name[_ngcontent-%COMP%]{font-weight:600}.dark-mode[_nghost-%COMP%], .dark-mode   [_nghost-%COMP%]{--divider-color: rgba(255, 255, 255, .08)}"],changeDetection:0})};function oe(i,t){if(i&1&&_(0),i&2){let e=c();O(" ",e._title(),`
`)}}var H=class i{_rosterIoService=x(A);_router=x(U);_weekNumberRouteService=x(N);_weekNumber$=this._weekNumberRouteService.weekNumber$;_weekNumber=this._weekNumberRouteService.weekNumber;_weekNumberString=this._weekNumberRouteService.weekNumberString;_title=g(()=>`Roster Week (${this._weekNumber()>0?"+":""}${this._weekNumberString()})`);_rosterState=z.CreateWithObservableInput(this._weekNumber$,t=>this._rosterIoService.getByWeek(t));_roster=g(()=>this._rosterState.data());_successMsg=this._rosterState.successMsg;_errorMsg=this._rosterState.errorMsg;_loading=this._rosterState.loading;previousWeek=()=>this._weekNumberRouteService.setWeek(this._weekNumber()-1);nextWeek=()=>this._weekNumberRouteService.setWeek(this._weekNumber()+1);onShiftSelected(t){console.log("Shift selected in roster table:",t,t.startTime<new Date),!(new Date(t.startTime)<new Date)&&this._router.navigate([`/${V.route("edit-shift")}/${t.shiftId}`])}static \u0275fac=function(e){return new(e||i)};static \u0275cmp=v({type:i,selectors:[["jt-roster"]],features:[J([N])],decls:11,vars:9,consts:[["titleTemplate",""],[1,"header"],[1,"week"],["jtTooltip","Previous Week","theme","primary",3,"click","iconName"],["jtTooltip","Next Week","theme","primary",3,"click","iconName"],[3,"selectedShiftItem","roster"],[3,"isLoading","errorMsg","successMsg"],["name","title",3,"portalTemplate"]],template:function(e,r){if(e&1){let o=w();l(0,"div",1)(1,"div",2)(2,"jt-ui-icon-button",3),f("click",function(){return m(o),p(r.previousWeek())}),s(),l(3,"h2"),_(4),s(),l(5,"jt-ui-icon-button",4),f("click",function(){return m(o),p(r.nextWeek())}),s()()(),l(6,"jt-ui-roster-table",5),f("selectedShiftItem",function(K){return m(o),p(r.onShiftSelected(K))}),s(),u(7,"jt-notifications-modal",6),P(8,oe,1,1,"ng-template",null,0,F),u(10,"sb-portal-input",7)}if(e&2){let o=D(9);a(2),d("iconName","arrow_circle_left"),a(2),k("Week (",r._weekNumber()>0?"+":"","",r._weekNumberString(),")"),a(),d("iconName","arrow_circle_right"),a(),d("roster",r._roster()),a(),d("isLoading",r._loading())("errorMsg",r._errorMsg())("successMsg",r._successMsg()),a(3),d("portalTemplate",o)}},dependencies:[q,B,L,G,M],styles:["[_nghost-%COMP%]{display:block;display:flex;flex-direction:column;gap:16px;align-items:center;justify-self:center;width:100%;min-height:100vh;padding-top:85px}jt-ui-roster-table[_ngcontent-%COMP%]{width:96%;max-width:1250px}.header[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:4px;align-items:center;position:fixed;top:50px;width:100%;background:var(--mat-sys-surface);z-index:10}.week[_ngcontent-%COMP%]{display:flex;align-items:center}"],changeDetection:0})};export{H as JtRosterPage};
