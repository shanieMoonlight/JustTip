import{a as H}from"./chunk-SR2YPCBO.js";import{a as R}from"./chunk-XUECQXR5.js";import{a as G}from"./chunk-5VA4Y6PK.js";import{b as z,g as A,i as L,j as q}from"./chunk-5M3UT6VB.js";import{j as V,k as B}from"./chunk-NLJGBAOU.js";import{Aa as I,Cb as g,Eb as j,Fb as E,Ia as h,Ja as x,Ka as b,Ma as y,Na as v,Oa as _,P as w,Pa as c,Pb as U,Qa as s,R as d,Ra as u,S as p,Wa as C,Ya as f,Za as l,eb as D,ec as $,ib as m,jb as P,jc as W,kb as J,la as a,lb as S,rb as O,vb as M,wa as k,xb as T,yb as F}from"./chunk-PYDYA4YI.js";function Y(t,i){if(t&1&&(c(0,"th",2),m(1),M(2,"date"),s()),t&2){let e=i.$implicit;a(),P(T(2,1,e.date,"EEE. MMM d"))}}function Z(t,i){if(t&1){let e=C();c(0,"div",11),f("click",function(){let r=d(e).$implicit,n=l(4);return p(n.edit(r))})("keydown.enter",function(){let r=d(e).$implicit,n=l(4);return p(n.edit(r))})("keydown.space",function(){let r=d(e).$implicit,n=l(4);return p(n.edit(r))}),m(1),M(2,"date"),M(3,"date"),s()}if(t&2){let e=i.$implicit;a(),S(" ",T(2,2,e.startTime,"shortTime")," \u2014 ",T(3,5,e.endTime,"shortTime")," ")}}function ee(t,i){if(t&1&&y(0,Z,4,8,"div",10,b),t&2){let e=l().$implicit,o=l().$implicit,r=l();v(r.getShifts(o.employeeId,e.date))}}function te(t,i){t&1&&u(0,"div",9)}function ie(t,i){if(t&1&&(c(0,"td",8),h(1,ee,2,0)(2,te,1,0,"div",9),s()),t&2){let e=i.$implicit,o=l().$implicit,r=l();a(),x(r.getShifts(o.employeeId,e.date).length?1:2)}}function re(t,i){if(t&1&&(c(0,"tr")(1,"td",3)(2,"div",4)(3,"div",5)(4,"jt-ui-icon",6),m(5,"face"),s()(),c(6,"div",7),m(7),s()()(),y(8,ie,3,1,"td",8,b),s()),t&2){let e=i.$implicit,o=l();a(4),_("iconSizePx",28),a(3),P(e.employeeName),a(),v(o.rosterDays())}}var N=class t{roster=E.required({});selectedShiftItem=j({});rosterDays=g(()=>this.roster()?.days??[]);employees=g(()=>{let i=this.rosterDays(),e=new Map;for(let o of i)for(let r of o.shifts??[]){let n=r.employeeId??r.employeeName??JSON.stringify(r);e.has(n)||e.set(n,{employeeId:r.employeeId,employeeName:r.employeeName})}return Array.from(e.values())});getShifts(i,e){let r=(this.rosterDays()??[]).find(n=>n.date===e);return r?(r.shifts??[]).filter(n=>(n.employeeId??n.employeeName)===(i??n.employeeName??"")):[]}edit=i=>this.selectedShiftItem.emit(i);static \u0275fac=function(e){return new(e||t)};static \u0275cmp=k({type:t,selectors:[["jt-ui-roster-table"]],inputs:{roster:[1,"roster"]},outputs:{selectedShiftItem:"selectedShiftItem"},decls:9,vars:0,consts:[["role","table",1,"roster-table"],["scope","col",1,"name-col","blank"],["scope","col",1,"date-col"],[1,"name-col"],[1,"name-cell"],[1,"avatar"],[3,"iconSizePx"],[1,"employee-name"],[1,"cell"],[1,"empty"],["role","button","tabindex","0",1,"shift"],["role","button","tabindex","0",1,"shift",3,"click","keydown.enter","keydown.space"]],template:function(e,o){e&1&&(c(0,"table",0)(1,"thead")(2,"tr"),u(3,"th",1),y(4,Y,3,4,"th",2,b),s()(),c(6,"tbody"),y(7,re,10,2,"tr",null,b),s()()),e&2&&(a(4),v(o.rosterDays()),a(3),v(o.employees()))},dependencies:[W,U],styles:["[_nghost-%COMP%]{display:block;--divider-color: rgba(0, 0, 0, .06);--cell-width: 160px;--cell-min-width: 120px;width:100%}.roster-table[_ngcontent-%COMP%]{margin:auto;border-collapse:collapse;table-layout:fixed;table-layout:auto}.roster-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .roster-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:12px 10px;border:1px solid var(--divider-color);vertical-align:middle;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.roster-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{top:0;z-index:3;font-weight:600;text-align:center}.roster-table[_ngcontent-%COMP%]   .name-col[_ngcontent-%COMP%]{text-align:left;gap:8px;left:0;z-index:2}.name-cell[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px}.roster-table[_ngcontent-%COMP%]   .date-col[_ngcontent-%COMP%], .roster-table[_ngcontent-%COMP%]   .cell[_ngcontent-%COMP%]{text-align:center}.shift[_ngcontent-%COMP%]{font-size:.9rem;font-size:.75rem;cursor:pointer}.empty[_ngcontent-%COMP%]{height:1.2rem}.avatar[_ngcontent-%COMP%]{width:32px;height:32px;border-radius:50%;display:inline-flex;align-items:center;justify-content:center;background:var(--mat-sys-secondary-container, #f2f2f2)}.employee-name[_ngcontent-%COMP%]{font-weight:600}.dark-mode[_nghost-%COMP%], .dark-mode   [_nghost-%COMP%]{--divider-color: rgba(255, 255, 255, .08)}"],changeDetection:0})};function oe(t,i){t&1&&u(0,"jt-no-data-card")}function ne(t,i){t&1&&(c(0,"h3",8),m(1,"No roster data available for this week."),s())}function ae(t,i){if(t&1&&h(0,oe,1,0,"jt-no-data-card")(1,ne,2,0,"h3",8),t&2){let e=l();x(!e._loading()&&!e._errorMsg()&&e._weekNumber()===0?0:1)}}function se(t,i){if(t&1){let e=C();c(0,"jt-ui-roster-table",9),f("selectedShiftItem",function(r){d(e);let n=l();return p(n.onShiftSelected(r))}),s()}if(t&2){let e=l();_("roster",e._roster())}}function le(t,i){if(t&1&&m(0),t&2){let e=l();J(" ",e._title(),`
`)}}var K=class t{_rosterIoService=w(A);_router=w($);_weekNumberRouteService=w(R);_weekNumber$=this._weekNumberRouteService.weekNumber$;_weekNumber=this._weekNumberRouteService.weekNumber;_weekNumberString=this._weekNumberRouteService.weekNumberString;_title=g(()=>`Roster Week (${this._weekNumber()>0?"+":""}${this._weekNumberString()})`);_rosterState=z.CreateWithObservableInput(this._weekNumber$,i=>this._rosterIoService.getByWeek(i));_roster=g(()=>this._rosterState.data());_successMsg=this._rosterState.successMsg;_errorMsg=this._rosterState.errorMsg;_loading=this._rosterState.loading;previousWeek=()=>this._weekNumberRouteService.setWeek(this._weekNumber()-1);nextWeek=()=>this._weekNumberRouteService.setWeek(this._weekNumber()+1);onShiftSelected(i){console.log("Shift selected in roster table:",i,i.startTime<new Date),!(new Date(i.startTime)<new Date)&&this._router.navigate([`/${V.route("edit-shift")}/${i.shiftId}`])}static \u0275fac=function(e){return new(e||t)};static \u0275cmp=k({type:t,selectors:[["jt-roster"]],features:[O([R])],decls:12,vars:9,consts:[["titleTemplate",""],[1,"header"],[1,"week"],["jtTooltip","Previous Week","theme","primary",3,"click","iconName"],["jtTooltip","Next Week","theme","primary",3,"click","iconName"],[3,"roster"],[3,"isLoading","errorMsg","successMsg"],["name","title",3,"portalTemplate"],[1,"no-roster-message"],[3,"selectedShiftItem","roster"]],template:function(e,o){if(e&1){let r=C();c(0,"div",1)(1,"div",2)(2,"jt-ui-icon-button",3),f("click",function(){return d(r),p(o.previousWeek())}),s(),c(3,"h2"),m(4),s(),c(5,"jt-ui-icon-button",4),f("click",function(){return d(r),p(o.nextWeek())}),s()()(),h(6,ae,2,1)(7,se,1,1,"jt-ui-roster-table",5),u(8,"jt-notifications-modal",6),I(9,le,1,1,"ng-template",null,0,F),u(11,"sb-portal-input",7)}if(e&2){let r,n=D(10);a(2),_("iconName","arrow_circle_left"),a(2),S("Week (",o._weekNumber()>0?"+":"","",o._weekNumberString(),")"),a(),_("iconName","arrow_circle_right"),a(),x(!((r=o._roster())==null||r.days==null)&&r.days.length?7:6),a(2),_("isLoading",o._loading())("errorMsg",o._errorMsg())("successMsg",o._successMsg()),a(3),_("portalTemplate",n)}},dependencies:[q,B,L,G,H,N],styles:["[_nghost-%COMP%]{display:block;display:flex;flex-direction:column;gap:16px;align-items:center;justify-self:center;width:100%;min-height:100vh;padding-top:85px}jt-ui-roster-table[_ngcontent-%COMP%]{width:96%;max-width:1250px}.header[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:4px;align-items:center;position:fixed;top:50px;width:100%;background:var(--mat-sys-surface);z-index:10}.week[_ngcontent-%COMP%]{display:flex;align-items:center}"],changeDetection:0})};export{K as JtRosterPage};
